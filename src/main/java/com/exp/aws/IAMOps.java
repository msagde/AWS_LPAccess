package com.exp.aws;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import software.amazon.awssdk.regions.Region;
import software.amazon.awssdk.services.iam.IamClient;
import software.amazon.awssdk.services.iam.model.AccessAdvisorUsageGranularityType;
import software.amazon.awssdk.services.iam.model.GenerateOrganizationsAccessReportRequest;
import software.amazon.awssdk.services.iam.model.GenerateOrganizationsAccessReportResponse;
import software.amazon.awssdk.services.iam.model.GenerateServiceLastAccessedDetailsRequest;
import software.amazon.awssdk.services.iam.model.GenerateServiceLastAccessedDetailsResponse;
import software.amazon.awssdk.services.iam.model.GetOrganizationsAccessReportRequest;
import software.amazon.awssdk.services.iam.model.GetOrganizationsAccessReportResponse;
import software.amazon.awssdk.services.iam.model.GetServiceLastAccessedDetailsRequest;
import software.amazon.awssdk.services.iam.model.GetServiceLastAccessedDetailsResponse;
import software.amazon.awssdk.services.iam.model.JobStatusType;
import software.amazon.awssdk.services.organizations.OrganizationsClient;
import software.amazon.awssdk.services.organizations.model.ChildType;
import software.amazon.awssdk.services.organizations.model.EnablePolicyTypeRequest;
import software.amazon.awssdk.services.organizations.model.ListAccountsRequest;
import software.amazon.awssdk.services.organizations.model.ListAccountsResponse;
import software.amazon.awssdk.services.organizations.model.ListChildrenRequest;
import software.amazon.awssdk.services.organizations.model.ListChildrenResponse;
import software.amazon.awssdk.services.organizations.model.ListRootsResponse;
import software.amazon.awssdk.services.organizations.model.PolicyType;

import java.util.concurrent.atomic.AtomicReference;

public class IAMOps {
    private static final Logger log = LoggerFactory.getLogger(IAMOps.class);

    private static String ROOT_ID  =  "r-zphj";


    public void getOrgAcceesInfo() {

        Region region = Region.AWS_GLOBAL;
        IamClient iam = IamClient.builder()
                .region(region)
                .build();

        OrganizationsClient oc = OrganizationsClient.builder().region(region).build();

        EnablePolicyTypeRequest enablePolicyTypeRequest = EnablePolicyTypeRequest.builder().policyType(PolicyType.SERVICE_CONTROL_POLICY).rootId(ROOT_ID).build();
        try {

            //ListAccountsResponse accounts = oc.listAccounts();
            ListAccountsRequest listAccountsRequest = ListAccountsRequest.builder().build();
            ListAccountsResponse accounts = oc.listAccounts(listAccountsRequest);

            ListRootsResponse listRootResp = oc.listRoots();

            listRootResp.roots().forEach(root -> {
                AtomicReference<String> entity = new AtomicReference<>("o-ziepcz5dc6/" + root.id());
                ListChildrenRequest lcReq = ListChildrenRequest.builder().parentId(root.id()).childType(ChildType.ORGANIZATIONAL_UNIT).build();
                ListChildrenResponse lcResp =  oc.listChildren(lcReq);

                lcResp.children().forEach(ou ->  {
                    entity.set(entity.get() + "/" + ou.id());
                    getLastAccessInfo(iam, entity.get());
                } );

                lcReq = ListChildrenRequest.builder().parentId(ROOT_ID).childType(ChildType.ACCOUNT).build();
                lcResp =  oc.listChildren(lcReq);

                lcResp.children().forEach(acc ->  {
                    entity.set(entity.get() + "/" + acc.id());
                    getLastAccessInfo(iam, entity.get());
                } );
            });

        } catch (Exception e) {
            e.printStackTrace();

        }


    }

    public void getLastAccessInfo(IamClient iam, String entity) {
//        String entity = "o-ziepcz5dc6/r-zphj/ou-zphj-7f8m4upv";
        //ou-zphj-7f8m4upv
//        entity = "o-ziepcz5dc6/r-zphj";

        log.info("Entity : {}", entity);
        GenerateOrganizationsAccessReportRequest generateOrganizationsAccessReportRequest
                = GenerateOrganizationsAccessReportRequest.builder().entityPath(entity).build();

        GenerateOrganizationsAccessReportResponse generateResp = null;
        try {
            generateResp = iam.generateOrganizationsAccessReport(generateOrganizationsAccessReportRequest);
        } catch (Exception e) {
            e.printStackTrace();
            return;
        }

        String jobId = generateResp.jobId();

        GetOrganizationsAccessReportRequest getOrganizationsAccessReportRequest
                = GetOrganizationsAccessReportRequest.builder().jobId(jobId).maxItems(1000).build();
        GetOrganizationsAccessReportResponse getResp = iam.getOrganizationsAccessReport(getOrganizationsAccessReportRequest);

        while(getResp.jobStatus().equals(JobStatusType.IN_PROGRESS)) {
            getResp = iam.getOrganizationsAccessReport(getOrganizationsAccessReportRequest);
        }


        getResp.accessDetails().forEach(accessDetail -> {
            log.info("-> {}", accessDetail.toString());
        });

        log.info("Resp {}", getResp.toString());
    }

    public void getServiceLastAccessedDetailsUsingARN(IamClient iamClient) {
        //   arn:aws:organizations::408777338031:account/o-ziepcz5dc6/408777338031
        String arn = "arn:aws:iam::408777338031:user/mahesh";
        //String arn = "arn:aws:organizations::408777338031:account/o-ziepcz5dc6/408777338031";
        GenerateServiceLastAccessedDetailsRequest getSAFReq = GenerateServiceLastAccessedDetailsRequest.builder().arn(arn).granularity(AccessAdvisorUsageGranularityType.ACTION_LEVEL).build();

        GenerateServiceLastAccessedDetailsResponse getSAFResp = iamClient.generateServiceLastAccessedDetails(getSAFReq);
        GetServiceLastAccessedDetailsRequest sadReq = GetServiceLastAccessedDetailsRequest.builder().jobId(getSAFResp.jobId()).maxItems(1000).build();

        GetServiceLastAccessedDetailsResponse sadResp = iamClient.getServiceLastAccessedDetails(sadReq);

        while(sadResp.jobStatus().equals(JobStatusType.IN_PROGRESS)) {
            sadResp = iamClient.getServiceLastAccessedDetails(sadReq);
        }
    }
}

// ListRootsResponse(Roots=[Root(Id=r-zphj, Arn=arn:aws:organizations::408777338031:root/o-ziepcz5dc6/r-zphj, Name=Root, PolicyTypes=[PolicyTypeSummary(Type=AISERVICES_OPT_OUT_POLICY, Status=ENABLED), PolicyTypeSummary(Type=BACKUP_POLICY, Status=ENABLED), PolicyTypeSummary(Type=TAG_POLICY, Status=ENABLED), PolicyTypeSummary(Type=SERVICE_CONTROL_POLICY, Status=ENABLED)])])
// GetOrganizationsAccessReportResponse(JobStatus=COMPLETED, JobCreationDate=2021-04-11T23:57:57.785Z, JobCompletionDate=2021-04-11T23:57:59.768Z, NumberOfServicesAccessible=264, NumberOfServicesNotAccessed=264, AccessDetails=[AccessDetail(ServiceName=Alexa for Business, ServiceNamespace=a4b,  AccessDetail(ServiceName=AWS IAM Access Analyzer, ServiceNamespace=access-analyzer,  AccessDetail(ServiceName=AWS Accounts, ServiceNamespace=account,  AccessDetail(ServiceName=AWS Certificate Manager, ServiceNamespace=acm,  AccessDetail(ServiceName=AWS Certificate Manager Private Certificate Authority, ServiceNamespace=acm-pca,  AccessDetail(ServiceName=AWS Activate, ServiceNamespace=activate,  AccessDetail(ServiceName=Amazon Managed Workflows for Apache Airflow, ServiceNamespace=airflow,  AccessDetail(ServiceName=AWS Amplify, ServiceNamespace=amplify,  AccessDetail(ServiceName=AWS Amplify Admin, ServiceNamespace=amplifybackend,  AccessDetail(ServiceName=Manage - Amazon API Gateway, ServiceNamespace=apigateway,  AccessDetail(ServiceName=Amazon AppIntegrations, ServiceNamespace=app-integrations,  AccessDetail(ServiceName=AWS AppConfig, ServiceNamespace=appconfig,  AccessDetail(ServiceName=Amazon AppFlow, ServiceNamespace=appflow,  AccessDetail(ServiceName=Application Auto Scaling, ServiceNamespace=application-autoscaling,  AccessDetail(ServiceName=CloudWatch Application Insights, ServiceNamespace=applicationinsights,  AccessDetail(ServiceName=AWS App Mesh, ServiceNamespace=appmesh,  AccessDetail(ServiceName=AWS App Mesh Preview, ServiceNamespace=appmesh-preview,  AccessDetail(ServiceName=Amazon AppStream 2.0, ServiceNamespace=appstream,  AccessDetail(ServiceName=AWS AppSync, ServiceNamespace=appsync,  AccessDetail(ServiceName=Amazon Managed Service for Prometheus, ServiceNamespace=aps,  AccessDetail(ServiceName=Application Discovery Arsenal, ServiceNamespace=arsenal,  AccessDetail(ServiceName=AWS Artifact, ServiceNamespace=artifact,  AccessDetail(ServiceName=Amazon Athena, ServiceNamespace=athena,  AccessDetail(ServiceName=AWS Audit Manager, ServiceNamespace=auditmanager,  AccessDetail(ServiceName=Amazon EC2 Auto Scaling, ServiceNamespace=autoscaling,  AccessDetail(ServiceName=AWS Auto Scaling, ServiceNamespace=autoscaling-plans,  AccessDetail(ServiceName=AWS Marketplace, ServiceNamespace=aws-marketplace,  AccessDetail(ServiceName=AWS Marketplace Management Portal, ServiceNamespace=aws-marketplace-management,  AccessDetail(ServiceName=AWS Billing, ServiceNamespace=aws-portal,  AccessDetail(ServiceName=AWS Connector Service, ServiceNamespace=awsconnector,  AccessDetail(ServiceName=AWS Backup, ServiceNamespace=backup,  AccessDetail(ServiceName=AWS Backup storage, ServiceNamespace=backup-storage,  AccessDetail(ServiceName=AWS Batch, ServiceNamespace=batch,  AccessDetail(ServiceName=Amazon Braket, ServiceNamespace=braket,  AccessDetail(ServiceName=AWS Budget Service, ServiceNamespace=budgets,  AccessDetail(ServiceName=Amazon Keyspaces (for Apache Cassandra), ServiceNamespace=cassandra,  AccessDetail(ServiceName=AWS Cost Explorer Service, ServiceNamespace=ce,  AccessDetail(ServiceName=AWS Chatbot, ServiceNamespace=chatbot,  AccessDetail(ServiceName=Amazon Chime, ServiceNamespace=chime,  AccessDetail(ServiceName=AWS Cloud9, ServiceNamespace=cloud9,  AccessDetail(ServiceName=Amazon Cloud Directory, ServiceNamespace=clouddirectory,  AccessDetail(ServiceName=AWS CloudFormation, ServiceNamespace=cloudformation,  AccessDetail(ServiceName=Amazon CloudFront, ServiceNamespace=cloudfront,  AccessDetail(ServiceName=AWS CloudHSM, ServiceNamespace=cloudhsm,  AccessDetail(ServiceName=Amazon CloudSearch, ServiceNamespace=cloudsearch,  AccessDetail(ServiceName=AWS CloudShell, ServiceNamespace=cloudshell,  AccessDetail(ServiceName=AWS CloudTrail, ServiceNamespace=cloudtrail,  AccessDetail(ServiceName=Amazon CloudWatch, ServiceNamespace=cloudwatch,  AccessDetail(ServiceName=AWS CodeArtifact, ServiceNamespace=codeartifact,  AccessDetail(ServiceName=AWS CodeBuild, ServiceNamespace=codebuild,  AccessDetail(ServiceName=AWS CodeCommit, ServiceNamespace=codecommit,  AccessDetail(ServiceName=AWS CodeDeploy, ServiceNamespace=codedeploy,  AccessDetail(ServiceName=Amazon CodeGuru, ServiceNamespace=codeguru,  AccessDetail(ServiceName=Amazon CodeGuru Profiler, ServiceNamespace=codeguru-profiler,  AccessDetail(ServiceName=Amazon CodeGuru Reviewer, ServiceNamespace=codeguru-reviewer,  AccessDetail(ServiceName=AWS CodePipeline, ServiceNamespace=codepipeline,  AccessDetail(ServiceName=AWS CodeStar, ServiceNamespace=codestar,  AccessDetail(ServiceName=AWS CodeStar Connections, ServiceNamespace=codestar-connections,  AccessDetail(ServiceName=AWS CodeStar Notifications, ServiceNamespace=codestar-notifications,  AccessDetail(ServiceName=Amazon Cognito Identity, ServiceNamespace=cognito-identity,  AccessDetail(ServiceName=Amazon Cognito User Pools, ServiceNamespace=cognito-idp,  AccessDetail(ServiceName=Amazon Cognito Sync, ServiceNamespace=cognito-sync,  AccessDetail(ServiceName=Amazon Comprehend, ServiceNamespace=comprehend,  AccessDetail(ServiceName=Amazon Comprehend Medical, ServiceNamespace=comprehendmedical,  AccessDetail(ServiceName=AWS Compute Optimizer, ServiceNamespace=compute-optimizer,  AccessDetail(ServiceName=AWS Config, ServiceNamespace=config,  AccessDetail(ServiceName=Amazon Connect, ServiceNamespace=connect,  AccessDetail(ServiceName=AWS Cost and Usage Report, ServiceNamespace=cur,  AccessDetail(ServiceName=AWS Glue DataBrew, ServiceNamespace=databrew,  AccessDetail(ServiceName=AWS Data Exchange, ServiceNamespace=dataexchange,  AccessDetail(ServiceName=Data Pipeline, ServiceNamespace=datapipeline,  AccessDetail(ServiceName=AWSDataSync, ServiceNamespace=datasync,  AccessDetail(ServiceName=Amazon DynamoDB Accelerator (DAX), ServiceNamespace=dax,  AccessDetail(ServiceName=Database Query Metadata Service, ServiceNamespace=dbqms,  AccessDetail(ServiceName=AWS DeepComposer, ServiceNamespace=deepcomposer,  AccessDetail(ServiceName=AWS DeepLens, ServiceNamespace=deeplens,  AccessDetail(ServiceName=AWS DeepRacer, ServiceNamespace=deepracer,  AccessDetail(ServiceName=Amazon Detective, ServiceNamespace=detective,  AccessDetail(ServiceName=AWS Device Farm, ServiceNamespace=devicefarm,  AccessDetail(ServiceName=Amazon DevOps Guru, ServiceNamespace=devops-guru,  AccessDetail(ServiceName=AWS Direct Connect, ServiceNamespace=directconnect,  AccessDetail(ServiceName=AWS Application Discovery Service, ServiceNamespace=discovery,  AccessDetail(ServiceName=Amazon Data Lifecycle Manager, ServiceNamespace=dlm,  AccessDetail(ServiceName=AWS Database Migration Service, ServiceNamespace=dms,  AccessDetail(ServiceName=AWS Directory Service, ServiceNamespace=ds,  AccessDetail(ServiceName=Amazon DynamoDB, ServiceNamespace=dynamodb,  AccessDetail(ServiceName=Amazon Elastic Block Store, ServiceNamespace=ebs,  AccessDetail(ServiceName=Amazon EC2, ServiceNamespace=ec2,  AccessDetail(ServiceName=Amazon EC2 Instance Connect, ServiceNamespace=ec2-instance-connect,  AccessDetail(ServiceName=Amazon Message Delivery Service, ServiceNamespace=ec2messages,  AccessDetail(ServiceName=Amazon Elastic Container Registry, ServiceNamespace=ecr,  AccessDetail(ServiceName=Amazon Elastic Container Registry Public, ServiceNamespace=ecr-public,  AccessDetail(ServiceName=Amazon Elastic Container Service, ServiceNamespace=ecs,  AccessDetail(ServiceName=Amazon Elastic Kubernetes Service, ServiceNamespace=eks,  AccessDetail(ServiceName=Amazon Elastic Inference, ServiceNamespace=elastic-inference,  AccessDetail(ServiceName=Amazon ElastiCache, ServiceNamespace=elasticache,  AccessDetail(ServiceName=AWS Elastic Beanstalk, ServiceNamespace=elasticbeanstalk,  AccessDetail(ServiceName=Amazon Elastic File System, ServiceNamespace=elasticfilesystem,  AccessDetail(ServiceName=Elastic Load Balancing, ServiceNamespace=elasticloadbalancing,  AccessDetail(ServiceName=Amazon Elastic MapReduce, ServiceNamespace=elasticmapreduce, TotalAuthenticatedEntities=0)], IsTruncated=true, Marker=AAxQH15LVZURe7vkFhBzY5subDI4Al+xOqGRHCkONbh6d85TyqX55Hjtdx9BC30Zf6lyXW/SNm4Jc7HXG1V2JYIX0dLDVAkJUFubNrbniLutCqSwipgUj4JbGFSf0YGEbC7pTBzyw+NB/jw14vW9gHPc)

// GetOrganizationsAccessReportResponse(JobStatus=COMPLETED, JobCreationDate=2021-04-12T00:00:26.989Z, JobCompletionDate=2021-04-12T00:00:28.602Z, NumberOfServicesAccessible=264, NumberOfServicesNotAccessed=264, AccessDetails=[AccessDetail(ServiceName=Alexa for Business, ServiceNamespace=a4b,  AccessDetail(ServiceName=AWS IAM Access Analyzer, ServiceNamespace=access-analyzer,  AccessDetail(ServiceName=AWS Accounts, ServiceNamespace=account,  AccessDetail(ServiceName=AWS Certificate Manager, ServiceNamespace=acm,  AccessDetail(ServiceName=AWS Certificate Manager Private Certificate Authority, ServiceNamespace=acm-pca,  AccessDetail(ServiceName=AWS Activate, ServiceNamespace=activate,  AccessDetail(ServiceName=Amazon Managed Workflows for Apache Airflow, ServiceNamespace=airflow,  AccessDetail(ServiceName=AWS Amplify, ServiceNamespace=amplify,  AccessDetail(ServiceName=AWS Amplify Admin, ServiceNamespace=amplifybackend,  AccessDetail(ServiceName=Manage - Amazon API Gateway, ServiceNamespace=apigateway,  AccessDetail(ServiceName=Amazon AppIntegrations, ServiceNamespace=app-integrations,  AccessDetail(ServiceName=AWS AppConfig, ServiceNamespace=appconfig,  AccessDetail(ServiceName=Amazon AppFlow, ServiceNamespace=appflow,  AccessDetail(ServiceName=Application Auto Scaling, ServiceNamespace=application-autoscaling,  AccessDetail(ServiceName=CloudWatch Application Insights, ServiceNamespace=applicationinsights,  AccessDetail(ServiceName=AWS App Mesh, ServiceNamespace=appmesh,  AccessDetail(ServiceName=AWS App Mesh Preview, ServiceNamespace=appmesh-preview,  AccessDetail(ServiceName=Amazon AppStream 2.0, ServiceNamespace=appstream,  AccessDetail(ServiceName=AWS AppSync, ServiceNamespace=appsync,  AccessDetail(ServiceName=Amazon Managed Service for Prometheus, ServiceNamespace=aps,  AccessDetail(ServiceName=Application Discovery Arsenal, ServiceNamespace=arsenal,  AccessDetail(ServiceName=AWS Artifact, ServiceNamespace=artifact,  AccessDetail(ServiceName=Amazon Athena, ServiceNamespace=athena,  AccessDetail(ServiceName=AWS Audit Manager, ServiceNamespace=auditmanager,  AccessDetail(ServiceName=Amazon EC2 Auto Scaling, ServiceNamespace=autoscaling,  AccessDetail(ServiceName=AWS Auto Scaling, ServiceNamespace=autoscaling-plans,  AccessDetail(ServiceName=AWS Marketplace, ServiceNamespace=aws-marketplace,  AccessDetail(ServiceName=AWS Marketplace Management Portal, ServiceNamespace=aws-marketplace-management,  AccessDetail(ServiceName=AWS Billing, ServiceNamespace=aws-portal,  AccessDetail(ServiceName=AWS Connector Service, ServiceNamespace=awsconnector,  AccessDetail(ServiceName=AWS Backup, ServiceNamespace=backup,  AccessDetail(ServiceName=AWS Backup storage, ServiceNamespace=backup-storage,  AccessDetail(ServiceName=AWS Batch, ServiceNamespace=batch,  AccessDetail(ServiceName=Amazon Braket, ServiceNamespace=braket,  AccessDetail(ServiceName=AWS Budget Service, ServiceNamespace=budgets,  AccessDetail(ServiceName=Amazon Keyspaces (for Apache Cassandra), ServiceNamespace=cassandra,  AccessDetail(ServiceName=AWS Cost Explorer Service, ServiceNamespace=ce,  AccessDetail(ServiceName=AWS Chatbot, ServiceNamespace=chatbot,  AccessDetail(ServiceName=Amazon Chime, ServiceNamespace=chime,  AccessDetail(ServiceName=AWS Cloud9, ServiceNamespace=cloud9,  AccessDetail(ServiceName=Amazon Cloud Directory, ServiceNamespace=clouddirectory,  AccessDetail(ServiceName=AWS CloudFormation, ServiceNamespace=cloudformation,  AccessDetail(ServiceName=Amazon CloudFront, ServiceNamespace=cloudfront,  AccessDetail(ServiceName=AWS CloudHSM, ServiceNamespace=cloudhsm,  AccessDetail(ServiceName=Amazon CloudSearch, ServiceNamespace=cloudsearch,  AccessDetail(ServiceName=AWS CloudShell, ServiceNamespace=cloudshell,  AccessDetail(ServiceName=AWS CloudTrail, ServiceNamespace=cloudtrail,  AccessDetail(ServiceName=Amazon CloudWatch, ServiceNamespace=cloudwatch,  AccessDetail(ServiceName=AWS CodeArtifact, ServiceNamespace=codeartifact,  AccessDetail(ServiceName=AWS CodeBuild, ServiceNamespace=codebuild,  AccessDetail(ServiceName=AWS CodeCommit, ServiceNamespace=codecommit,  AccessDetail(ServiceName=AWS CodeDeploy, ServiceNamespace=codedeploy,  AccessDetail(ServiceName=Amazon CodeGuru, ServiceNamespace=codeguru,  AccessDetail(ServiceName=Amazon CodeGuru Profiler, ServiceNamespace=codeguru-profiler,  AccessDetail(ServiceName=Amazon CodeGuru Reviewer, ServiceNamespace=codeguru-reviewer,  AccessDetail(ServiceName=AWS CodePipeline, ServiceNamespace=codepipeline,  AccessDetail(ServiceName=AWS CodeStar, ServiceNamespace=codestar,  AccessDetail(ServiceName=AWS CodeStar Connections, ServiceNamespace=codestar-connections,  AccessDetail(ServiceName=AWS CodeStar Notifications, ServiceNamespace=codestar-notifications,  AccessDetail(ServiceName=Amazon Cognito Identity, ServiceNamespace=cognito-identity,  AccessDetail(ServiceName=Amazon Cognito User Pools, ServiceNamespace=cognito-idp,  AccessDetail(ServiceName=Amazon Cognito Sync, ServiceNamespace=cognito-sync,  AccessDetail(ServiceName=Amazon Comprehend, ServiceNamespace=comprehend,  AccessDetail(ServiceName=Amazon Comprehend Medical, ServiceNamespace=comprehendmedical,  AccessDetail(ServiceName=AWS Compute Optimizer, ServiceNamespace=compute-optimizer,  AccessDetail(ServiceName=AWS Config, ServiceNamespace=config,  AccessDetail(ServiceName=Amazon Connect, ServiceNamespace=connect,  AccessDetail(ServiceName=AWS Cost and Usage Report, ServiceNamespace=cur,  AccessDetail(ServiceName=AWS Glue DataBrew, ServiceNamespace=databrew,  AccessDetail(ServiceName=AWS Data Exchange, ServiceNamespace=dataexchange,  AccessDetail(ServiceName=Data Pipeline, ServiceNamespace=datapipeline,  AccessDetail(ServiceName=AWSDataSync, ServiceNamespace=datasync,  AccessDetail(ServiceName=Amazon DynamoDB Accelerator (DAX), ServiceNamespace=dax,  AccessDetail(ServiceName=Database Query Metadata Service, ServiceNamespace=dbqms,  AccessDetail(ServiceName=AWS DeepComposer, ServiceNamespace=deepcomposer,  AccessDetail(ServiceName=AWS DeepLens, ServiceNamespace=deeplens,  AccessDetail(ServiceName=AWS DeepRacer, ServiceNamespace=deepracer,  AccessDetail(ServiceName=Amazon Detective, ServiceNamespace=detective,  AccessDetail(ServiceName=AWS Device Farm, ServiceNamespace=devicefarm,  AccessDetail(ServiceName=Amazon DevOps Guru, ServiceNamespace=devops-guru,  AccessDetail(ServiceName=AWS Direct Connect, ServiceNamespace=directconnect,  AccessDetail(ServiceName=AWS Application Discovery Service, ServiceNamespace=discovery,  AccessDetail(ServiceName=Amazon Data Lifecycle Manager, ServiceNamespace=dlm,  AccessDetail(ServiceName=AWS Database Migration Service, ServiceNamespace=dms,  AccessDetail(ServiceName=AWS Directory Service, ServiceNamespace=ds,  AccessDetail(ServiceName=Amazon DynamoDB, ServiceNamespace=dynamodb,  AccessDetail(ServiceName=Amazon Elastic Block Store, ServiceNamespace=ebs,  AccessDetail(ServiceName=Amazon EC2, ServiceNamespace=ec2,  AccessDetail(ServiceName=Amazon EC2 Instance Connect, ServiceNamespace=ec2-instance-connect,  AccessDetail(ServiceName=Amazon Message Delivery Service, ServiceNamespace=ec2messages,  AccessDetail(ServiceName=Amazon Elastic Container Registry, ServiceNamespace=ecr,  AccessDetail(ServiceName=Amazon Elastic Container Registry Public, ServiceNamespace=ecr-public,  AccessDetail(ServiceName=Amazon Elastic Container Service, ServiceNamespace=ecs,  AccessDetail(ServiceName=Amazon Elastic Kubernetes Service, ServiceNamespace=eks,  AccessDetail(ServiceName=Amazon Elastic Inference, ServiceNamespace=elastic-inference,  AccessDetail(ServiceName=Amazon ElastiCache, ServiceNamespace=elasticache,  AccessDetail(ServiceName=AWS Elastic Beanstalk, ServiceNamespace=elasticbeanstalk,  AccessDetail(ServiceName=Amazon Elastic File System, ServiceNamespace=elasticfilesystem,  AccessDetail(ServiceName=Elastic Load Balancing, ServiceNamespace=elasticloadbalancing,  AccessDetail(ServiceName=Amazon Elastic MapReduce, ServiceNamespace=elasticmapreduce, TotalAuthenticatedEntities=0)], IsTruncated=true, Marker=AC72Q1jc3V3I8WdJ06Dn7GMaj+E9xccHYIoQ67lvernaHrcP6KwaCed6o8v+sBftbHNiaJ3/B3zMxhIdiOEgUKovGIRHPL1mkJT0RoIHJsTyaqJTnOzKFcbDDJk2ye2TJZoV4KBEE9mkj4Kvy4ejVyZM)
// GetOrganizationsAccessReportResponse(JobStatus=COMPLETED, JobCreationDate=2021-04-12T00:02:38.863Z, JobCompletionDate=2021-04-12T00:02:40.145Z, NumberOfServicesAccessible=264, NumberOfServicesNotAccessed=264, AccessDetails=[AccessDetail(ServiceName=Alexa for Business, ServiceNamespace=a4b,  AccessDetail(ServiceName=AWS IAM Access Analyzer, ServiceNamespace=access-analyzer,  AccessDetail(ServiceName=AWS Accounts, ServiceNamespace=account,  AccessDetail(ServiceName=AWS Certificate Manager, ServiceNamespace=acm,  AccessDetail(ServiceName=AWS Certificate Manager Private Certificate Authority, ServiceNamespace=acm-pca,  AccessDetail(ServiceName=AWS Activate, ServiceNamespace=activate,  AccessDetail(ServiceName=Amazon Managed Workflows for Apache Airflow, ServiceNamespace=airflow,  AccessDetail(ServiceName=AWS Amplify, ServiceNamespace=amplify,  AccessDetail(ServiceName=AWS Amplify Admin, ServiceNamespace=amplifybackend,  AccessDetail(ServiceName=Manage - Amazon API Gateway, ServiceNamespace=apigateway,  AccessDetail(ServiceName=Amazon AppIntegrations, ServiceNamespace=app-integrations,  AccessDetail(ServiceName=AWS AppConfig, ServiceNamespace=appconfig,  AccessDetail(ServiceName=Amazon AppFlow, ServiceNamespace=appflow,  AccessDetail(ServiceName=Application Auto Scaling, ServiceNamespace=application-autoscaling,  AccessDetail(ServiceName=CloudWatch Application Insights, ServiceNamespace=applicationinsights,  AccessDetail(ServiceName=AWS App Mesh, ServiceNamespace=appmesh,  AccessDetail(ServiceName=AWS App Mesh Preview, ServiceNamespace=appmesh-preview,  AccessDetail(ServiceName=Amazon AppStream 2.0, ServiceNamespace=appstream,  AccessDetail(ServiceName=AWS AppSync, ServiceNamespace=appsync,  AccessDetail(ServiceName=Amazon Managed Service for Prometheus, ServiceNamespace=aps,  AccessDetail(ServiceName=Application Discovery Arsenal, ServiceNamespace=arsenal,  AccessDetail(ServiceName=AWS Artifact, ServiceNamespace=artifact,  AccessDetail(ServiceName=Amazon Athena, ServiceNamespace=athena,  AccessDetail(ServiceName=AWS Audit Manager, ServiceNamespace=auditmanager,  AccessDetail(ServiceName=Amazon EC2 Auto Scaling, ServiceNamespace=autoscaling,  AccessDetail(ServiceName=AWS Auto Scaling, ServiceNamespace=autoscaling-plans,  AccessDetail(ServiceName=AWS Marketplace, ServiceNamespace=aws-marketplace,  AccessDetail(ServiceName=AWS Marketplace Management Portal, ServiceNamespace=aws-marketplace-management,  AccessDetail(ServiceName=AWS Billing, ServiceNamespace=aws-portal,  AccessDetail(ServiceName=AWS Connector Service, ServiceNamespace=awsconnector,  AccessDetail(ServiceName=AWS Backup, ServiceNamespace=backup,  AccessDetail(ServiceName=AWS Backup storage, ServiceNamespace=backup-storage,  AccessDetail(ServiceName=AWS Batch, ServiceNamespace=batch,  AccessDetail(ServiceName=Amazon Braket, ServiceNamespace=braket,  AccessDetail(ServiceName=AWS Budget Service, ServiceNamespace=budgets,  AccessDetail(ServiceName=Amazon Keyspaces (for Apache Cassandra), ServiceNamespace=cassandra,  AccessDetail(ServiceName=AWS Cost Explorer Service, ServiceNamespace=ce,  AccessDetail(ServiceName=AWS Chatbot, ServiceNamespace=chatbot,  AccessDetail(ServiceName=Amazon Chime, ServiceNamespace=chime,  AccessDetail(ServiceName=AWS Cloud9, ServiceNamespace=cloud9,  AccessDetail(ServiceName=Amazon Cloud Directory, ServiceNamespace=clouddirectory,  AccessDetail(ServiceName=AWS CloudFormation, ServiceNamespace=cloudformation,  AccessDetail(ServiceName=Amazon CloudFront, ServiceNamespace=cloudfront,  AccessDetail(ServiceName=AWS CloudHSM, ServiceNamespace=cloudhsm,  AccessDetail(ServiceName=Amazon CloudSearch, ServiceNamespace=cloudsearch,  AccessDetail(ServiceName=AWS CloudShell, ServiceNamespace=cloudshell,  AccessDetail(ServiceName=AWS CloudTrail, ServiceNamespace=cloudtrail,  AccessDetail(ServiceName=Amazon CloudWatch, ServiceNamespace=cloudwatch,  AccessDetail(ServiceName=AWS CodeArtifact, ServiceNamespace=codeartifact,  AccessDetail(ServiceName=AWS CodeBuild, ServiceNamespace=codebuild,  AccessDetail(ServiceName=AWS CodeCommit, ServiceNamespace=codecommit,  AccessDetail(ServiceName=AWS CodeDeploy, ServiceNamespace=codedeploy,  AccessDetail(ServiceName=Amazon CodeGuru, ServiceNamespace=codeguru,  AccessDetail(ServiceName=Amazon CodeGuru Profiler, ServiceNamespace=codeguru-profiler,  AccessDetail(ServiceName=Amazon CodeGuru Reviewer, ServiceNamespace=codeguru-reviewer,  AccessDetail(ServiceName=AWS CodePipeline, ServiceNamespace=codepipeline,  AccessDetail(ServiceName=AWS CodeStar, ServiceNamespace=codestar,  AccessDetail(ServiceName=AWS CodeStar Connections, ServiceNamespace=codestar-connections,  AccessDetail(ServiceName=AWS CodeStar Notifications, ServiceNamespace=codestar-notifications,  AccessDetail(ServiceName=Amazon Cognito Identity, ServiceNamespace=cognito-identity,  AccessDetail(ServiceName=Amazon Cognito User Pools, ServiceNamespace=cognito-idp,  AccessDetail(ServiceName=Amazon Cognito Sync, ServiceNamespace=cognito-sync,  AccessDetail(ServiceName=Amazon Comprehend, ServiceNamespace=comprehend,  AccessDetail(ServiceName=Amazon Comprehend Medical, ServiceNamespace=comprehendmedical,  AccessDetail(ServiceName=AWS Compute Optimizer, ServiceNamespace=compute-optimizer,  AccessDetail(ServiceName=AWS Config, ServiceNamespace=config,  AccessDetail(ServiceName=Amazon Connect, ServiceNamespace=connect,  AccessDetail(ServiceName=AWS Cost and Usage Report, ServiceNamespace=cur,  AccessDetail(ServiceName=AWS Glue DataBrew, ServiceNamespace=databrew,  AccessDetail(ServiceName=AWS Data Exchange, ServiceNamespace=dataexchange,  AccessDetail(ServiceName=Data Pipeline, ServiceNamespace=datapipeline,  AccessDetail(ServiceName=AWSDataSync, ServiceNamespace=datasync,  AccessDetail(ServiceName=Amazon DynamoDB Accelerator (DAX), ServiceNamespace=dax,  AccessDetail(ServiceName=Database Query Metadata Service, ServiceNamespace=dbqms,  AccessDetail(ServiceName=AWS DeepComposer, ServiceNamespace=deepcomposer,  AccessDetail(ServiceName=AWS DeepLens, ServiceNamespace=deeplens,  AccessDetail(ServiceName=AWS DeepRacer, ServiceNamespace=deepracer,  AccessDetail(ServiceName=Amazon Detective, ServiceNamespace=detective,  AccessDetail(ServiceName=AWS Device Farm, ServiceNamespace=devicefarm,  AccessDetail(ServiceName=Amazon DevOps Guru, ServiceNamespace=devops-guru,  AccessDetail(ServiceName=AWS Direct Connect, ServiceNamespace=directconnect,  AccessDetail(ServiceName=AWS Application Discovery Service, ServiceNamespace=discovery,  AccessDetail(ServiceName=Amazon Data Lifecycle Manager, ServiceNamespace=dlm,  AccessDetail(ServiceName=AWS Database Migration Service, ServiceNamespace=dms,  AccessDetail(ServiceName=AWS Directory Service, ServiceNamespace=ds,  AccessDetail(ServiceName=Amazon DynamoDB, ServiceNamespace=dynamodb,  AccessDetail(ServiceName=Amazon Elastic Block Store, ServiceNamespace=ebs,  AccessDetail(ServiceName=Amazon EC2, ServiceNamespace=ec2,  AccessDetail(ServiceName=Amazon EC2 Instance Connect, ServiceNamespace=ec2-instance-connect,  AccessDetail(ServiceName=Amazon Message Delivery Service, ServiceNamespace=ec2messages,  AccessDetail(ServiceName=Amazon Elastic Container Registry, ServiceNamespace=ecr,  AccessDetail(ServiceName=Amazon Elastic Container Registry Public, ServiceNamespace=ecr-public,  AccessDetail(ServiceName=Amazon Elastic Container Service, ServiceNamespace=ecs,  AccessDetail(ServiceName=Amazon Elastic Kubernetes Service, ServiceNamespace=eks,  AccessDetail(ServiceName=Amazon Elastic Inference, ServiceNamespace=elastic-inference,  AccessDetail(ServiceName=Amazon ElastiCache, ServiceNamespace=elasticache,  AccessDetail(ServiceName=AWS Elastic Beanstalk, ServiceNamespace=elasticbeanstalk,  AccessDetail(ServiceName=Amazon Elastic File System, ServiceNamespace=elasticfilesystem,  AccessDetail(ServiceName=Elastic Load Balancing, ServiceNamespace=elasticloadbalancing,  AccessDetail(ServiceName=Amazon Elastic MapReduce, ServiceNamespace=elasticmapreduce, TotalAuthenticatedEntities=0)], IsTruncated=true, Marker=ABrtradri8r//1XSSw9jO+fQiAhyKQN5dvDldazXA9nkOPNwvC3zC5JKZR/q1lt2NNF/7pnJp20pQfQhS4Y6cu5vFvuJ15VoOFF8UoG0iMXLJJecKvNf8Umqe6R7MHyW5nsTzKSI5Lb7zV0bH080Q+om)
// GetOrganizationsAccessReportResponse(JobStatus=IN_PROGRESS, JobCreationDate=2021-04-12T00:03:37.479Z, IsTruncated=false)


    //GetServiceLastAccessedDetailsResponse(JobStatus=COMPLETED, JobType=ACTION_LEVEL, JobCreationDate=2021-04-12T01:07:19.566Z, ServicesLastAccessed=[ServiceLastAccessed(ServiceName=Alexa for Business, ServiceNamespace=a4b, TotalAuthenticatedEntities=0)
 /*
 ServiceLastAccessed(ServiceName=AWS IAM Access Analyzer, ServiceNamespace=access-analyzer, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Accounts, ServiceNamespace=account, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Certificate Manager, ServiceNamespace=acm, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Certificate Manager Private Certificate Authority, ServiceNamespace=acm-pca, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Activate, ServiceNamespace=activate, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Managed Workflows for Apache Airflow, ServiceNamespace=airflow, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Amplify, ServiceNamespace=amplify, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Amplify Admin, ServiceNamespace=amplifybackend, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Manage - Amazon API Gateway, ServiceNamespace=apigateway, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon AppIntegrations, ServiceNamespace=app-integrations, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS AppConfig, ServiceNamespace=appconfig, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon AppFlow, ServiceNamespace=appflow, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Application Auto Scaling, ServiceNamespace=application-autoscaling, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=CloudWatch Application Insights, ServiceNamespace=applicationinsights, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS App Mesh, ServiceNamespace=appmesh, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS App Mesh Preview, ServiceNamespace=appmesh-preview, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon AppStream 2.0, ServiceNamespace=appstream, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS AppSync, ServiceNamespace=appsync, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Managed Service for Prometheus, ServiceNamespace=aps, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Application Discovery Arsenal, ServiceNamespace=arsenal, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Artifact, ServiceNamespace=artifact, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Athena, ServiceNamespace=athena, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Audit Manager, ServiceNamespace=auditmanager, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon EC2 Auto Scaling, ServiceNamespace=autoscaling, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Auto Scaling, ServiceNamespace=autoscaling-plans, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Marketplace, ServiceNamespace=aws-marketplace, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Marketplace Management Portal, ServiceNamespace=aws-marketplace-management, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Billing, ServiceNamespace=aws-portal, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Connector Service, ServiceNamespace=awsconnector, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Backup, ServiceNamespace=backup, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Backup storage, ServiceNamespace=backup-storage, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Batch, ServiceNamespace=batch, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Braket, ServiceNamespace=braket, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Budget Service, ServiceNamespace=budgets, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Keyspaces (for Apache Cassandra), ServiceNamespace=cassandra, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Cost Explorer Service, ServiceNamespace=ce, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Chatbot, ServiceNamespace=chatbot, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Chime, ServiceNamespace=chime, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Cloud9, ServiceNamespace=cloud9, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Cloud Directory, ServiceNamespace=clouddirectory, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CloudFormation, ServiceNamespace=cloudformation, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon CloudFront, ServiceNamespace=cloudfront, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CloudHSM, ServiceNamespace=cloudhsm, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon CloudSearch, ServiceNamespace=cloudsearch, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CloudShell, ServiceNamespace=cloudshell, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CloudTrail, ServiceNamespace=cloudtrail, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon CloudWatch, ServiceNamespace=cloudwatch, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CodeArtifact, ServiceNamespace=codeartifact, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CodeBuild, ServiceNamespace=codebuild, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CodeCommit, ServiceNamespace=codecommit, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CodeDeploy, ServiceNamespace=codedeploy, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon CodeGuru, ServiceNamespace=codeguru, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon CodeGuru Profiler, ServiceNamespace=codeguru-profiler, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon CodeGuru Reviewer, ServiceNamespace=codeguru-reviewer, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CodePipeline, ServiceNamespace=codepipeline, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CodeStar, ServiceNamespace=codestar, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CodeStar Connections, ServiceNamespace=codestar-connections, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS CodeStar Notifications, ServiceNamespace=codestar-notifications, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Cognito Identity, ServiceNamespace=cognito-identity, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Cognito User Pools, ServiceNamespace=cognito-idp, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Cognito Sync, ServiceNamespace=cognito-sync, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Comprehend, ServiceNamespace=comprehend, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Comprehend Medical, ServiceNamespace=comprehendmedical, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Compute Optimizer, ServiceNamespace=compute-optimizer, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Config, ServiceNamespace=config, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Connect, ServiceNamespace=connect, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Cost and Usage Report, ServiceNamespace=cur, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Glue DataBrew, ServiceNamespace=databrew, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Data Exchange, ServiceNamespace=dataexchange, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Data Pipeline, ServiceNamespace=datapipeline, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWSDataSync, ServiceNamespace=datasync, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon DynamoDB Accelerator (DAX), ServiceNamespace=dax, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Database Query Metadata Service, ServiceNamespace=dbqms, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS DeepComposer, ServiceNamespace=deepcomposer, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS DeepLens, ServiceNamespace=deeplens, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS DeepRacer, ServiceNamespace=deepracer, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Detective, ServiceNamespace=detective, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Device Farm, ServiceNamespace=devicefarm, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon DevOps Guru, ServiceNamespace=devops-guru, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Direct Connect, ServiceNamespace=directconnect, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Application Discovery Service, ServiceNamespace=discovery, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Data Lifecycle Manager, ServiceNamespace=dlm, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Database Migration Service, ServiceNamespace=dms, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Directory Service, ServiceNamespace=ds, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon DynamoDB, ServiceNamespace=dynamodb, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elastic Block Store, ServiceNamespace=ebs, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon EC2, ServiceNamespace=ec2, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon EC2 Instance Connect, ServiceNamespace=ec2-instance-connect, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Message Delivery Service, ServiceNamespace=ec2messages, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elastic Container Registry, ServiceNamespace=ecr, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elastic Container Registry Public, ServiceNamespace=ecr-public, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elastic Container Service, ServiceNamespace=ecs, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elastic Kubernetes Service, ServiceNamespace=eks, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elastic Inference, ServiceNamespace=elastic-inference, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon ElastiCache, ServiceNamespace=elasticache, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elastic Beanstalk, ServiceNamespace=elasticbeanstalk, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elastic File System, ServiceNamespace=elasticfilesystem, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Elastic Load Balancing, ServiceNamespace=elasticloadbalancing, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elastic MapReduce, ServiceNamespace=elasticmapreduce, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elastic Transcoder, ServiceNamespace=elastictranscoder, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elemental Appliances and Software Activation Service, ServiceNamespace=elemental-activations, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elemental Appliances and Software, ServiceNamespace=elemental-appliances-software, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Elemental Support Cases, ServiceNamespace=elemental-support-cases, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Elemental Support Content, ServiceNamespace=elemental-support-content, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon EMR on EKS (EMR Containers), ServiceNamespace=emr-containers, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Elasticsearch Service, ServiceNamespace=es, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon EventBridge, ServiceNamespace=events, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon API Gateway, ServiceNamespace=execute-api, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Kinesis Firehose, ServiceNamespace=firehose, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Fault Injection Simulator, ServiceNamespace=fis, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Firewall Manager, ServiceNamespace=fms, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Forecast, ServiceNamespace=forecast, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Fraud Detector, ServiceNamespace=frauddetector, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon FreeRTOS, ServiceNamespace=freertos, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon FSx, ServiceNamespace=fsx, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon GameLift, ServiceNamespace=gamelift, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Location, ServiceNamespace=geo, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Glacier, ServiceNamespace=glacier, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Global Accelerator, ServiceNamespace=globalaccelerator, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Glue, ServiceNamespace=glue, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Managed Service for Grafana, ServiceNamespace=grafana, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT Greengrass, ServiceNamespace=greengrass, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Ground Station, ServiceNamespace=groundstation, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon GroundTruth Labeling, ServiceNamespace=groundtruthlabeling, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon GuardDuty, ServiceNamespace=guardduty, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Health APIs and Notifications, ServiceNamespace=health, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon HealthLake, ServiceNamespace=healthlake, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Honeycode, ServiceNamespace=honeycode, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Identity and Access Management, LastAuthenticated=2021-04-12T00:45:29Z, ServiceNamespace=iam, LastAuthenticatedEntity=arn:aws:iam::408777338031:user/mahesh, LastAuthenticatedRegion=us-east-1, TotalAuthenticatedEntities=1)
 ServiceLastAccessed(ServiceName=AWS Identity Store, ServiceNamespace=identitystore, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon EC2 Image Builder, ServiceNamespace=imagebuilder, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Import Export, ServiceNamespace=importexport, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Inspector, ServiceNamespace=inspector, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT, ServiceNamespace=iot, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT Device Tester, ServiceNamespace=iot-device-tester, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT 1-Click, ServiceNamespace=iot1click, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT Analytics, ServiceNamespace=iotanalytics, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT Core Device Advisor, ServiceNamespace=iotdeviceadvisor, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT Events, ServiceNamespace=iotevents, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT Fleet Hub for Device Management, ServiceNamespace=iotfleethub, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT SiteWise, ServiceNamespace=iotsitewise, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT Things Graph, ServiceNamespace=iotthingsgraph, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IoT Core for LoRaWAN, ServiceNamespace=iotwireless, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IQ, ServiceNamespace=iq, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS IQ Permissions, ServiceNamespace=iq-permission, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Interactive Video Service, ServiceNamespace=ivs, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Managed Streaming for Apache Kafka, ServiceNamespace=kafka, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Kendra, ServiceNamespace=kendra, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Kinesis, ServiceNamespace=kinesis, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Kinesis Analytics, ServiceNamespace=kinesisanalytics, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Kinesis Video Streams, ServiceNamespace=kinesisvideo, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Key Management Service, ServiceNamespace=kms, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Lake Formation, ServiceNamespace=lakeformation, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Lambda, ServiceNamespace=lambda, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Launch Wizard, ServiceNamespace=launchwizard, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Lex, ServiceNamespace=lex, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS License Manager, ServiceNamespace=license-manager, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Lightsail, ServiceNamespace=lightsail, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon CloudWatch Logs, ServiceNamespace=logs, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Lookout for Equipment, ServiceNamespace=lookoutequipment, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Lookout for Metrics, ServiceNamespace=lookoutmetrics, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Lookout for Vision, ServiceNamespace=lookoutvision, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Machine Learning, ServiceNamespace=machinelearning, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Macie Classic, ServiceNamespace=macie, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Macie, ServiceNamespace=macie2, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Managed Blockchain, ServiceNamespace=managedblockchain, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Marketplace Commerce Analytics Service, ServiceNamespace=marketplacecommerceanalytics, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Mechanical Turk, ServiceNamespace=mechanicalturk, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elemental MediaConnect, ServiceNamespace=mediaconnect, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elemental MediaConvert, ServiceNamespace=mediaconvert, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elemental MediaLive, ServiceNamespace=medialive, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elemental MediaPackage, ServiceNamespace=mediapackage, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elemental MediaPackage VOD, ServiceNamespace=mediapackage-vod, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elemental MediaStore, ServiceNamespace=mediastore, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Elemental MediaTailor, ServiceNamespace=mediatailor, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Migration Hub, ServiceNamespace=mgh, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Application Migration Service, ServiceNamespace=mgn, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Mobile Analytics, ServiceNamespace=mobileanalytics, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Mobile Hub, ServiceNamespace=mobilehub, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Pinpoint, ServiceNamespace=mobiletargeting, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Monitron, ServiceNamespace=monitron, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon MQ, ServiceNamespace=mq, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Neptune, ServiceNamespace=neptune-db, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Network Firewall, ServiceNamespace=network-firewall, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Network Manager, ServiceNamespace=networkmanager, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS OpsWorks, ServiceNamespace=opsworks, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS OpsWorks Configuration Management, ServiceNamespace=opsworks-cm, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Organizations, LastAuthenticated=2021-04-12T00:14:53Z, ServiceNamespace=organizations, LastAuthenticatedEntity=arn:aws:iam::408777338031:user/mahesh, LastAuthenticatedRegion=us-east-1, TotalAuthenticatedEntities=1)
 ServiceLastAccessed(ServiceName=AWS Outposts, ServiceNamespace=outposts, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Panorama, ServiceNamespace=panorama, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Personalize, ServiceNamespace=personalize, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Performance Insights, ServiceNamespace=pi, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Polly, ServiceNamespace=polly, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Price List, ServiceNamespace=pricing, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Connect Customer Profiles, ServiceNamespace=profile, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Proton, ServiceNamespace=proton, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Purchase Orders Console, ServiceNamespace=purchase-orders, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon QLDB, ServiceNamespace=qldb, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon QuickSight, ServiceNamespace=quicksight, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Resource Access Manager, ServiceNamespace=ram, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon RDS, ServiceNamespace=rds, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon RDS Data API, ServiceNamespace=rds-data, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon RDS IAM Authentication, ServiceNamespace=rds-db, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Redshift, ServiceNamespace=redshift, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Redshift Data API, ServiceNamespace=redshift-data, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Rekognition, ServiceNamespace=rekognition, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Tag Editor, ServiceNamespace=resource-explorer, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Resource Groups, ServiceNamespace=resource-groups, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS RoboMaker, ServiceNamespace=robomaker, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Route 53, ServiceNamespace=route53, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Route53 Domains, ServiceNamespace=route53domains, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Route 53 Resolver, ServiceNamespace=route53resolver, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon S3, LastAuthenticated=2021-04-12T00:10:17Z, ServiceNamespace=s3, LastAuthenticatedEntity=arn:aws:iam::408777338031:user/mahesh, LastAuthenticatedRegion=us-west-2, TotalAuthenticatedEntities=1, TrackedActionsLastAccessed=[TrackedActionLastAccessed(ActionName=CreateAccessPoint), TrackedActionLastAccessed(ActionName=CreateBucket, LastAccessedEntity=arn:aws:iam::408777338031:user/mahesh, LastAccessedTime=2021-04-12T00:10:17Z, LastAccessedRegion=us-west-2), TrackedActionLastAccessed(ActionName=CreateJob), TrackedActionLastAccessed(ActionName=DeleteAccessPoint), TrackedActionLastAccessed(ActionName=DeleteAccessPointPolicy), TrackedActionLastAccessed(ActionName=DeleteBucket, LastAccessedEntity=arn:aws:iam::408777338031:user/mahesh, LastAccessedTime=2021-04-10T19:16:27Z, LastAccessedRegion=us-west-2), TrackedActionLastAccessed(ActionName=DeleteBucketPolicy), TrackedActionLastAccessed(ActionName=DeleteBucketWebsite), TrackedActionLastAccessed(ActionName=DeleteJobTagging), TrackedActionLastAccessed(ActionName=DeleteStorageLensConfiguration), TrackedActionLastAccessed(ActionName=DeleteStorageLensConfigurationTagging), TrackedActionLastAccessed(ActionName=DescribeJob), TrackedActionLastAccessed(ActionName=GetAccessPoint), TrackedActionLastAccessed(ActionName=GetAccessPointPolicy), TrackedActionLastAccessed(ActionName=GetAccessPointPolicyStatus), TrackedActionLastAccessed(ActionName=GetAccountPublicAccessBlock), TrackedActionLastAccessed(ActionName=GetBucketAcl), TrackedActionLastAccessed(ActionName=GetBucketCORS), TrackedActionLastAccessed(ActionName=GetBucketLocation), TrackedActionLastAccessed(ActionName=GetBucketLogging), TrackedActionLastAccessed(ActionName=GetBucketNotification), TrackedActionLastAccessed(ActionName=GetBucketObjectLockConfiguration), TrackedActionLastAccessed(ActionName=GetBucketPolicy), TrackedActionLastAccessed(ActionName=GetBucketPolicyStatus), TrackedActionLastAccessed(ActionName=GetBucketPublicAccessBlock), TrackedActionLastAccessed(ActionName=GetBucketRequestPayment), TrackedActionLastAccessed(ActionName=GetBucketTagging), TrackedActionLastAccessed(ActionName=GetBucketVersioning), TrackedActionLastAccessed(ActionName=GetBucketWebsite), TrackedActionLastAccessed(ActionName=GetEncryptionConfiguration), TrackedActionLastAccessed(ActionName=GetJobTagging), TrackedActionLastAccessed(ActionName=GetLifecycleConfiguration), TrackedActionLastAccessed(ActionName=GetReplicationConfiguration), TrackedActionLastAccessed(ActionName=GetStorageLensConfiguration), TrackedActionLastAccessed(ActionName=GetStorageLensConfigurationTagging), TrackedActionLastAccessed(ActionName=GetStorageLensDashboard), TrackedActionLastAccessed(ActionName=ListAccessPoints), TrackedActionLastAccessed(ActionName=ListAllMyBuckets), TrackedActionLastAccessed(ActionName=ListJobs), TrackedActionLastAccessed(ActionName=ListStorageLensConfigurations), TrackedActionLastAccessed(ActionName=PutAccessPointPolicy), TrackedActionLastAccessed(ActionName=PutAccountPublicAccessBlock), TrackedActionLastAccessed(ActionName=PutBucketAcl), TrackedActionLastAccessed(ActionName=PutBucketCORS), TrackedActionLastAccessed(ActionName=PutBucketLogging), TrackedActionLastAccessed(ActionName=PutBucketNotification), TrackedActionLastAccessed(ActionName=PutBucketObjectLockConfiguration), TrackedActionLastAccessed(ActionName=PutBucketPolicy), TrackedActionLastAccessed(ActionName=PutBucketPublicAccessBlock), TrackedActionLastAccessed(ActionName=PutBucketRequestPayment), TrackedActionLastAccessed(ActionName=PutBucketTagging), TrackedActionLastAccessed(ActionName=PutBucketVersioning), TrackedActionLastAccessed(ActionName=PutBucketWebsite), TrackedActionLastAccessed(ActionName=PutEncryptionConfiguration), TrackedActionLastAccessed(ActionName=PutJobTagging), TrackedActionLastAccessed(ActionName=PutLifecycleConfiguration), TrackedActionLastAccessed(ActionName=PutReplicationConfiguration), TrackedActionLastAccessed(ActionName=PutStorageLensConfiguration), TrackedActionLastAccessed(ActionName=PutStorageLensConfigurationTagging), TrackedActionLastAccessed(ActionName=UpdateJobPriority), TrackedActionLastAccessed(ActionName=UpdateJobStatus)])
 ServiceLastAccessed(ServiceName=Amazon S3 Object Lambda, ServiceNamespace=s3-object-lambda, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon S3 on Outposts, ServiceNamespace=s3-outposts, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon SageMaker, ServiceNamespace=sagemaker, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Savings Plans, ServiceNamespace=savingsplans, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon EventBridge Schemas, ServiceNamespace=schemas, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon SimpleDB, ServiceNamespace=sdb, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Secrets Manager, ServiceNamespace=secretsmanager, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Security Hub, ServiceNamespace=securityhub, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Serverless Application Repository, ServiceNamespace=serverlessrepo, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Service Catalog, ServiceNamespace=servicecatalog, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Cloud Map, ServiceNamespace=servicediscovery, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Service Quotas, ServiceNamespace=servicequotas, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon SES, ServiceNamespace=ses, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Shield, ServiceNamespace=shield, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Signer, ServiceNamespace=signer, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Server Migration Service, ServiceNamespace=sms, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Pinpoint SMS and Voice Service, ServiceNamespace=sms-voice, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Snowball, ServiceNamespace=snowball, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon SNS, ServiceNamespace=sns, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon SQS, ServiceNamespace=sqs, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Systems Manager, ServiceNamespace=ssm, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Session Manager Message Gateway Service, ServiceNamespace=ssmmessages, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS SSO, ServiceNamespace=sso, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS SSO Directory, ServiceNamespace=sso-directory, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Step Functions, ServiceNamespace=states, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Storage Gateway, ServiceNamespace=storagegateway, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Security Token Service, ServiceNamespace=sts, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Sumerian, ServiceNamespace=sumerian, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Support, ServiceNamespace=support, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Simple Workflow Service, ServiceNamespace=swf, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon CloudWatch Synthetics, ServiceNamespace=synthetics, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Resource Group Tagging API, ServiceNamespace=tag, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Textract, ServiceNamespace=textract, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Timestream, ServiceNamespace=timestream, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Tiros, ServiceNamespace=tiros, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Transcribe, ServiceNamespace=transcribe, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Transfer for SFTP, ServiceNamespace=transfer, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon Translate, ServiceNamespace=translate, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Trusted Advisor, ServiceNamespace=trustedadvisor, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS WAF, ServiceNamespace=waf, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS WAF Regional, ServiceNamespace=waf-regional, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS WAF V2, ServiceNamespace=wafv2, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon WorkSpaces Application Manager, ServiceNamespace=wam, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS Well-Architected Tool, ServiceNamespace=wellarchitected, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon WorkDocs, ServiceNamespace=workdocs, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon WorkLink, ServiceNamespace=worklink, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon WorkMail, ServiceNamespace=workmail, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon WorkMail Message Flow, ServiceNamespace=workmailmessageflow, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=Amazon WorkSpaces, ServiceNamespace=workspaces, TotalAuthenticatedEntities=0)
 ServiceLastAccessed(ServiceName=AWS X-Ray, ServiceNamespace=xray, TotalAuthenticatedEntities=0)], JobCompletionDate=2021-04-12T01:07:20.877Z, IsTruncated=false)*/



////////////// ORG

//    GetOrganizationsAccessReportResponse(JobStatus=COMPLETED, JobCreationDate=2021-04-12T01:12:16.638Z, JobCompletionDate=2021-04-12T01:12:19.321Z, NumberOfServicesAccessible=264, NumberOfServicesNotAccessed=264, AccessDetails=[AccessDetail(ServiceName=Alexa for Business, ServiceNamespace=a4b, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IAM Access Analyzer, ServiceNamespace=access-analyzer, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Accounts, ServiceNamespace=account, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Certificate Manager, ServiceNamespace=acm, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Certificate Manager Private Certificate Authority, ServiceNamespace=acm-pca, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Activate, ServiceNamespace=activate, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Managed Workflows for Apache Airflow, ServiceNamespace=airflow, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Amplify, ServiceNamespace=amplify, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Amplify Admin, ServiceNamespace=amplifybackend, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Manage - Amazon API Gateway, ServiceNamespace=apigateway, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon AppIntegrations, ServiceNamespace=app-integrations, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS AppConfig, ServiceNamespace=appconfig, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon AppFlow, ServiceNamespace=appflow, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Application Auto Scaling, ServiceNamespace=application-autoscaling, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=CloudWatch Application Insights, ServiceNamespace=applicationinsights, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS App Mesh, ServiceNamespace=appmesh, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS App Mesh Preview, ServiceNamespace=appmesh-preview, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon AppStream 2.0, ServiceNamespace=appstream, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS AppSync, ServiceNamespace=appsync, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Managed Service for Prometheus, ServiceNamespace=aps, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Application Discovery Arsenal, ServiceNamespace=arsenal, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Artifact, ServiceNamespace=artifact, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Athena, ServiceNamespace=athena, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Audit Manager, ServiceNamespace=auditmanager, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon EC2 Auto Scaling, ServiceNamespace=autoscaling, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Auto Scaling, ServiceNamespace=autoscaling-plans, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Marketplace, ServiceNamespace=aws-marketplace, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Marketplace Management Portal, ServiceNamespace=aws-marketplace-management, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Billing, ServiceNamespace=aws-portal, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Connector Service, ServiceNamespace=awsconnector, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Backup, ServiceNamespace=backup, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Backup storage, ServiceNamespace=backup-storage, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Batch, ServiceNamespace=batch, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Braket, ServiceNamespace=braket, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Budget Service, ServiceNamespace=budgets, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Keyspaces (for Apache Cassandra), ServiceNamespace=cassandra, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Cost Explorer Service, ServiceNamespace=ce, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Chatbot, ServiceNamespace=chatbot, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Chime, ServiceNamespace=chime, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Cloud9, ServiceNamespace=cloud9, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Cloud Directory, ServiceNamespace=clouddirectory, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CloudFormation, ServiceNamespace=cloudformation, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon CloudFront, ServiceNamespace=cloudfront, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CloudHSM, ServiceNamespace=cloudhsm, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon CloudSearch, ServiceNamespace=cloudsearch, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CloudShell, ServiceNamespace=cloudshell, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CloudTrail, ServiceNamespace=cloudtrail, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon CloudWatch, ServiceNamespace=cloudwatch, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CodeArtifact, ServiceNamespace=codeartifact, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CodeBuild, ServiceNamespace=codebuild, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CodeCommit, ServiceNamespace=codecommit, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CodeDeploy, ServiceNamespace=codedeploy, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon CodeGuru, ServiceNamespace=codeguru, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon CodeGuru Profiler, ServiceNamespace=codeguru-profiler, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon CodeGuru Reviewer, ServiceNamespace=codeguru-reviewer, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CodePipeline, ServiceNamespace=codepipeline, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CodeStar, ServiceNamespace=codestar, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CodeStar Connections, ServiceNamespace=codestar-connections, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS CodeStar Notifications, ServiceNamespace=codestar-notifications, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Cognito Identity, ServiceNamespace=cognito-identity, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Cognito User Pools, ServiceNamespace=cognito-idp, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Cognito Sync, ServiceNamespace=cognito-sync, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Comprehend, ServiceNamespace=comprehend, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Comprehend Medical, ServiceNamespace=comprehendmedical, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Compute Optimizer, ServiceNamespace=compute-optimizer, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Config, ServiceNamespace=config, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Connect, ServiceNamespace=connect, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Cost and Usage Report, ServiceNamespace=cur, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Glue DataBrew, ServiceNamespace=databrew, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Data Exchange, ServiceNamespace=dataexchange, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Data Pipeline, ServiceNamespace=datapipeline, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWSDataSync, ServiceNamespace=datasync, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon DynamoDB Accelerator (DAX), ServiceNamespace=dax, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Database Query Metadata Service, ServiceNamespace=dbqms, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS DeepComposer, ServiceNamespace=deepcomposer, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS DeepLens, ServiceNamespace=deeplens, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS DeepRacer, ServiceNamespace=deepracer, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Detective, ServiceNamespace=detective, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Device Farm, ServiceNamespace=devicefarm, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon DevOps Guru, ServiceNamespace=devops-guru, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Direct Connect, ServiceNamespace=directconnect, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Application Discovery Service, ServiceNamespace=discovery, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Data Lifecycle Manager, ServiceNamespace=dlm, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Database Migration Service, ServiceNamespace=dms, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Directory Service, ServiceNamespace=ds, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon DynamoDB, ServiceNamespace=dynamodb, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elastic Block Store, ServiceNamespace=ebs, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon EC2, ServiceNamespace=ec2, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon EC2 Instance Connect, ServiceNamespace=ec2-instance-connect, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Message Delivery Service, ServiceNamespace=ec2messages, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elastic Container Registry, ServiceNamespace=ecr, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elastic Container Registry Public, ServiceNamespace=ecr-public, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elastic Container Service, ServiceNamespace=ecs, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elastic Kubernetes Service, ServiceNamespace=eks, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elastic Inference, ServiceNamespace=elastic-inference, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon ElastiCache, ServiceNamespace=elasticache, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elastic Beanstalk, ServiceNamespace=elasticbeanstalk, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elastic File System, ServiceNamespace=elasticfilesystem, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Elastic Load Balancing, ServiceNamespace=elasticloadbalancing, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elastic MapReduce, ServiceNamespace=elasticmapreduce, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elastic Transcoder, ServiceNamespace=elastictranscoder, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elemental Appliances and Software Activation Service, ServiceNamespace=elemental-activations, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elemental Appliances and Software, ServiceNamespace=elemental-appliances-software, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Elemental Support Cases, ServiceNamespace=elemental-support-cases, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Elemental Support Content, ServiceNamespace=elemental-support-content, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon EMR on EKS (EMR Containers), ServiceNamespace=emr-containers, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Elasticsearch Service, ServiceNamespace=es, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon EventBridge, ServiceNamespace=events, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon API Gateway, ServiceNamespace=execute-api, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Kinesis Firehose, ServiceNamespace=firehose, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Fault Injection Simulator, ServiceNamespace=fis, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Firewall Manager, ServiceNamespace=fms, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Forecast, ServiceNamespace=forecast, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Fraud Detector, ServiceNamespace=frauddetector, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon FreeRTOS, ServiceNamespace=freertos, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon FSx, ServiceNamespace=fsx, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon GameLift, ServiceNamespace=gamelift, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Location, ServiceNamespace=geo, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Glacier, ServiceNamespace=glacier, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Global Accelerator, ServiceNamespace=globalaccelerator, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Glue, ServiceNamespace=glue, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Managed Service for Grafana, ServiceNamespace=grafana, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT Greengrass, ServiceNamespace=greengrass, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Ground Station, ServiceNamespace=groundstation, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon GroundTruth Labeling, ServiceNamespace=groundtruthlabeling, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon GuardDuty, ServiceNamespace=guardduty, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Health APIs and Notifications, ServiceNamespace=health, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon HealthLake, ServiceNamespace=healthlake, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Honeycode, ServiceNamespace=honeycode, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Identity and Access Management, ServiceNamespace=iam, Region=us-east-1, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Identity Store, ServiceNamespace=identitystore, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon EC2 Image Builder, ServiceNamespace=imagebuilder, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Import Export, ServiceNamespace=importexport, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Inspector, ServiceNamespace=inspector, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT, ServiceNamespace=iot, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT Device Tester, ServiceNamespace=iot-device-tester, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT 1-Click, ServiceNamespace=iot1click, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT Analytics, ServiceNamespace=iotanalytics, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT Core Device Advisor, ServiceNamespace=iotdeviceadvisor, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT Events, ServiceNamespace=iotevents, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT Fleet Hub for Device Management, ServiceNamespace=iotfleethub, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT SiteWise, ServiceNamespace=iotsitewise, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT Things Graph, ServiceNamespace=iotthingsgraph, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IoT Core for LoRaWAN, ServiceNamespace=iotwireless, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IQ, ServiceNamespace=iq, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS IQ Permissions, ServiceNamespace=iq-permission, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Interactive Video Service, ServiceNamespace=ivs, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Managed Streaming for Apache Kafka, ServiceNamespace=kafka, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Kendra, ServiceNamespace=kendra, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Kinesis, ServiceNamespace=kinesis, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Kinesis Analytics, ServiceNamespace=kinesisanalytics, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Kinesis Video Streams, ServiceNamespace=kinesisvideo, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Key Management Service, ServiceNamespace=kms, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Lake Formation, ServiceNamespace=lakeformation, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Lambda, ServiceNamespace=lambda, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Launch Wizard, ServiceNamespace=launchwizard, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Lex, ServiceNamespace=lex, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS License Manager, ServiceNamespace=license-manager, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Lightsail, ServiceNamespace=lightsail, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon CloudWatch Logs, ServiceNamespace=logs, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Lookout for Equipment, ServiceNamespace=lookoutequipment, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Lookout for Metrics, ServiceNamespace=lookoutmetrics, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Lookout for Vision, ServiceNamespace=lookoutvision, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Machine Learning, ServiceNamespace=machinelearning, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Macie Classic, ServiceNamespace=macie, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Macie, ServiceNamespace=macie2, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Managed Blockchain, ServiceNamespace=managedblockchain, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Marketplace Commerce Analytics Service, ServiceNamespace=marketplacecommerceanalytics, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Mechanical Turk, ServiceNamespace=mechanicalturk, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elemental MediaConnect, ServiceNamespace=mediaconnect, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elemental MediaConvert, ServiceNamespace=mediaconvert, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elemental MediaLive, ServiceNamespace=medialive, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elemental MediaPackage, ServiceNamespace=mediapackage, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elemental MediaPackage VOD, ServiceNamespace=mediapackage-vod, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elemental MediaStore, ServiceNamespace=mediastore, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Elemental MediaTailor, ServiceNamespace=mediatailor, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Migration Hub, ServiceNamespace=mgh, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Application Migration Service, ServiceNamespace=mgn, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Mobile Analytics, ServiceNamespace=mobileanalytics, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Mobile Hub, ServiceNamespace=mobilehub, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Pinpoint, ServiceNamespace=mobiletargeting, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Monitron, ServiceNamespace=monitron, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon MQ, ServiceNamespace=mq, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Neptune, ServiceNamespace=neptune-db, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Network Firewall, ServiceNamespace=network-firewall, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Network Manager, ServiceNamespace=networkmanager, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS OpsWorks, ServiceNamespace=opsworks, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS OpsWorks Configuration Management, ServiceNamespace=opsworks-cm, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Organizations, ServiceNamespace=organizations, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Outposts, ServiceNamespace=outposts, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Panorama, ServiceNamespace=panorama, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Personalize, ServiceNamespace=personalize, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Performance Insights, ServiceNamespace=pi, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Polly, ServiceNamespace=polly, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Price List, ServiceNamespace=pricing, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Connect Customer Profiles, ServiceNamespace=profile, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Proton, ServiceNamespace=proton, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Purchase Orders Console, ServiceNamespace=purchase-orders, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon QLDB, ServiceNamespace=qldb, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon QuickSight, ServiceNamespace=quicksight, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Resource Access Manager, ServiceNamespace=ram, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon RDS, ServiceNamespace=rds, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon RDS Data API, ServiceNamespace=rds-data, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon RDS IAM Authentication, ServiceNamespace=rds-db, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Redshift, ServiceNamespace=redshift, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Redshift Data API, ServiceNamespace=redshift-data, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Rekognition, ServiceNamespace=rekognition, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Tag Editor, ServiceNamespace=resource-explorer, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Resource Groups, ServiceNamespace=resource-groups, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS RoboMaker, ServiceNamespace=robomaker, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Route 53, ServiceNamespace=route53, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Route53 Domains, ServiceNamespace=route53domains, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Route 53 Resolver, ServiceNamespace=route53resolver, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon S3, ServiceNamespace=s3, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon S3 Object Lambda, ServiceNamespace=s3-object-lambda, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon S3 on Outposts, ServiceNamespace=s3-outposts, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon SageMaker, ServiceNamespace=sagemaker, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Savings Plans, ServiceNamespace=savingsplans, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon EventBridge Schemas, ServiceNamespace=schemas, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon SimpleDB, ServiceNamespace=sdb, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Secrets Manager, ServiceNamespace=secretsmanager, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Security Hub, ServiceNamespace=securityhub, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Serverless Application Repository, ServiceNamespace=serverlessrepo, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Service Catalog, ServiceNamespace=servicecatalog, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Cloud Map, ServiceNamespace=servicediscovery, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Service Quotas, ServiceNamespace=servicequotas, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon SES, ServiceNamespace=ses, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Shield, ServiceNamespace=shield, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Signer, ServiceNamespace=signer, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Server Migration Service, ServiceNamespace=sms, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Pinpoint SMS and Voice Service, ServiceNamespace=sms-voice, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Snowball, ServiceNamespace=snowball, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon SNS, ServiceNamespace=sns, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon SQS, ServiceNamespace=sqs, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Systems Manager, ServiceNamespace=ssm, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Session Manager Message Gateway Service, ServiceNamespace=ssmmessages, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS SSO, ServiceNamespace=sso, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS SSO Directory, ServiceNamespace=sso-directory, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Step Functions, ServiceNamespace=states, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Storage Gateway, ServiceNamespace=storagegateway, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Security Token Service, ServiceNamespace=sts, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Sumerian, ServiceNamespace=sumerian, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Support, ServiceNamespace=support, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Simple Workflow Service, ServiceNamespace=swf, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon CloudWatch Synthetics, ServiceNamespace=synthetics, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Resource Group Tagging API, ServiceNamespace=tag, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Textract, ServiceNamespace=textract, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Timestream, ServiceNamespace=timestream, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Tiros, ServiceNamespace=tiros, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Transcribe, ServiceNamespace=transcribe, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Transfer for SFTP, ServiceNamespace=transfer, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon Translate, ServiceNamespace=translate, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Trusted Advisor, ServiceNamespace=trustedadvisor, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS WAF, ServiceNamespace=waf, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS WAF Regional, ServiceNamespace=waf-regional, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS WAF V2, ServiceNamespace=wafv2, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon WorkSpaces Application Manager, ServiceNamespace=wam, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS Well-Architected Tool, ServiceNamespace=wellarchitected, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon WorkDocs, ServiceNamespace=workdocs, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon WorkLink, ServiceNamespace=worklink, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon WorkMail, ServiceNamespace=workmail, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon WorkMail Message Flow, ServiceNamespace=workmailmessageflow, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=Amazon WorkSpaces, ServiceNamespace=workspaces, TotalAuthenticatedEntities=0), AccessDetail(ServiceName=AWS X-Ray, ServiceNamespace=xray, TotalAuthenticatedEntities=0)], IsTruncated=false)




//        {
//                      arn:aws:organizations::408777338031:account/o-ziepcz5dc6/408777338031
//        String arn = "arn:aws:organizations::408777338031:account/o-ziepcz5dc6/408777338031";
//            GenerateServiceLastAccessedDetailsRequest generateServiceLastAccessedDetailsRequest
//                    = GenerateServiceLastAccessedDetailsRequest.builder().arn(arn).build();
//
//            GenerateServiceLastAccessedDetailsResponse resp =
//            iam.generateServiceLastAccessedDetails(generateServiceLastAccessedDetailsRequest);
//
//            GetServiceLastAccessedDetailsResponse getServiceLastAccessedDetailsResponse = GetServiceLastAccessedDetailsResponse.builder().j
//            iam.getServiceLastAccessedDetails(generateServiceLastAccessedDetailsRequest);
//        }

//        ListAccountsForParentRequest listAccountsForParentRequest = ListAccountsForParentRequest.builder().parentId("ou-zphj-7f8m4upv").maxResults(20).build();
//        ListAccountsForParentResponse listAccountsForParentResponse =  oc.listAccountsForParent(listAccountsForParentRequest);
//
//        ListRootsResponse resp = oc.listRoots();
//        oc.enablePolicyType(enablePolicyTypeRequest);



//GetAccountSummaryResponse summaryResponse = iam.getAccountSummary();
//        {
//   arn:aws:organizations::408777338031:account/o-ziepcz5dc6/408777338031
//            // arn:aws:iam::408777338031:user/mahesh
//            GenerateServiceLastAccessedDetailsRequest getSAFReq = GenerateServiceLastAccessedDetailsRequest.builder().arn("arn:aws:iam::408777338031:user/mahesh").granularity(AccessAdvisorUsageGranularityType.ACTION_LEVEL).build();
//
//            GenerateServiceLastAccessedDetailsResponse getSAFResp = iam.generateServiceLastAccessedDetails(getSAFReq);
//            GetServiceLastAccessedDetailsRequest sadReq = GetServiceLastAccessedDetailsRequest.builder().jobId(getSAFResp.jobId()).maxItems(1000).build();
//
//            GetServiceLastAccessedDetailsResponse sadResp = iam.getServiceLastAccessedDetails(sadReq);
//
//
//
//
//            while(sadResp.jobStatus().equals(JobStatusType.IN_PROGRESS)) {
//                sadResp = iam.getServiceLastAccessedDetails(sadReq);
//
//            }
//            GetServiceLastAccessedDetailsWithEntitiesRequest sadeReq = GetServiceLastAccessedDetailsWithEntitiesRequest.builder().jobId(getSAFResp.jobId()).maxItems(100).build();
//            GetServiceLastAccessedDetailsWithEntitiesResponse sadeResp = iam.getServiceLastAccessedDetailsWithEntities(sadeReq);
//            sadeResp = iam.getServiceLastAccessedDetailsWithEntities(sadeReq);
//
//            log.info("Resp {}", sadResp.toString());
//
//        }
// ORG


/*
       {
//   arn:aws:organizations::408777338031:account/o-ziepcz5dc6/408777338031
            String arn = "arn:aws:iam::408777338031:user/mahesh";
            //String arn = "arn:aws:organizations::408777338031:account/o-ziepcz5dc6/408777338031";
            GenerateServiceLastAccessedDetailsRequest getSAFReq = GenerateServiceLastAccessedDetailsRequest.builder().arn(arn).granularity(AccessAdvisorUsageGranularityType.ACTION_LEVEL).build();

            GenerateServiceLastAccessedDetailsResponse getSAFResp = iam.generateServiceLastAccessedDetails(getSAFReq);
            GetServiceLastAccessedDetailsRequest sadReq = GetServiceLastAccessedDetailsRequest.builder().jobId(getSAFResp.jobId()).maxItems(1000).build();

            GetServiceLastAccessedDetailsResponse sadResp = iam.getServiceLastAccessedDetails(sadReq);

            while(sadResp.jobStatus().equals(JobStatusType.IN_PROGRESS)) {
                sadResp = iam.getServiceLastAccessedDetails(sadReq);
            }
//

        }

 */